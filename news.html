<!doctype html>
<html lang="el">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Δράσεις & Ανακοινώσεις — Η ΦΙΛΑΔΕΛΦΕΙΑ</title>
  <meta name="description" content="Όλες οι δράσεις και ανακοινώσεις του σωματείου Η ΦΙΛΑΔΕΛΦΕΙΑ." />
  <meta name="theme-color" content="#f97316" />

  <link rel="icon" href="/favicon.ico" sizes="any">
  <link rel="icon" href="/favicon.svg" type="image/svg+xml">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  <link rel="manifest" href="/site.webmanifest">

  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="/styles.css">
</head>
<body class="min-h-screen bg-gradient-to-b from-orange-600 via-orange-500 to-orange-300 text-white antialiased">
  <header class="border-b border-white/15 backdrop-blur bg-white/10">
    <div class="max-w-6xl mx-auto px-4 py-4 flex items-center justify-between gap-6">
      <a href="/index.html" class="flex items-center gap-3">
        <img src="/filadelfeia_logo.svg" alt="Λογότυπο Η ΦΙΛΑΔΕΛΦΕΙΑ" class="h-9 w-9" />
        <span class="font-semibold tracking-wide">Η ΦΙΛΑΔΕΛΦΕΙΑ</span>
      </a>
      <nav class="flex gap-5 text-white/90">
        <a href="/index.html" data-active="home" class="hover:underline">Αρχική</a>
        <a href="/about.html" data-active="about" class="hover:underline">Το Σωματείο</a>
        <a href="/news.html" data-active="news" class="hover:underline">Δράσεις & Ανακοινώσεις</a>
        <a href="/contact.html" data-active="contact" class="hover:underline">Επικοινωνία</a>
      </nav>
    </div>
  </header>

  <main class="max-w-6xl mx-auto px-4 py-12">
    <h1 class="text-3xl font-bold">Δράσεις & Ανακοινώσεις</h1>
    <div id="news-list" class="mt-8 grid gap-6">
      <p id="news-loading" class="text-white/80">Φόρτωση ανακοινώσεων…</p>
    </div>
  </main>

  <footer class="border-t border-white/15 mt-16">
    <div class="max-w-6xl mx-auto px-4 py-8 text-white/80 text-sm">
      <p>© <span id="year"></span> Δημόσιο site του σωματείου «Η ΦΙΛΑΔΕΛΦΕΙΑ». Όλα τα δικαιώματα διατηρούνται.</p>
    </div>
  </footer>

  <!-- Προαιρετικό inline fallback για τοπικό άνοιγμα (file://) -->
  <script id="announcements-fallback" type="application/json">[]</script>

  <script src="/site.js" defer></script>
<script>
  document.addEventListener('DOMContentLoaded', async () => {
    const y=document.getElementById('year'); if(y) y.textContent=new Date().getFullYear();

    async function loadJSON() {
      try {
        const res = await fetch(`/data/announcements.json?v=${Date.now()}`, { cache: 'no-store' });
        if (!res.ok) throw new Error('HTTP '+res.status);
        return await res.json();
      } catch (e) {
        const fb = document.getElementById('announcements-fallback');
        return fb?.textContent ? JSON.parse(fb.textContent) : [];
      }
    }

    function fmt(d){ try { return d ? new Date(d).toLocaleDateString('el-GR') : ''; } catch { return ''; } }

    // INDEX: γεμίζει τις 3 τελευταίες
    const latestBox = document.getElementById('latest');
    if (latestBox) {
      latestBox.innerHTML = '<p class="text-white/80">Φόρτωση ανακοινώσεων…</p>';
      const data = await loadJSON();
      const latest = [...data].sort((a,b)=> (b.date||'').localeCompare(a.date||'')).slice(0,3);
      latestBox.innerHTML = latest.length ? latest.map(item => `
        <article class="rounded-2xl p-5 bg-white/10 border border-white/10">
          <div class="text-sm text-white/80">${fmt(item.date)}</div>
          <h3 class="text-xl font-semibold mt-1">${item.title||''}</h3>
          <p class="mt-2 text-white/90">${item.summary ?? item.body ?? ''}</p>
        </article>`).join('') : '<p class="text-white/80">Δεν υπάρχουν ανακοινώσεις.</p>';
    }

    // NEWS: γεμίζει όλες
    const listBox = document.getElementById('news-list');
    if (listBox) {
      listBox.innerHTML = '<p class="text-white/80">Φόρτωση ανακοινώσεων…</p>';
      const data = await loadJSON();
      const sorted = [...data].sort((a,b)=> (b.date||'').localeCompare(a.date||''));
      listBox.innerHTML = sorted.length ? sorted.map(item => `
        <article class="rounded-2xl p-5 bg-white/10 border border-white/10">
          <div class="text-sm text-white/80">${fmt(item.date)}</div>
          <h2 class="text-xl font-semibold mt-1">${item.title||''}</h2>
          <p class="mt-2 text-white/90">${item.summary ?? item.body ?? ''}</p>
          ${item.tags?.length ? `<div class="mt-3 flex flex-wrap gap-2">${item.tags.map(t=>`<span class="text-xs px-2 py-1 rounded-full bg-black/20">#${t}</span>`).join('')}</div>` : ''}
        </article>`).join('') : '<p class="text-white/80">Δεν υπάρχουν ανακοινώσεις.</p>';
    }
  });
</script>

</body>
</html>
